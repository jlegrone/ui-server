import{S as J,i as z,s as G,J as fe,e as m,t as P,k as L,c as v,a as $,g as W,d as i,n as q,b as g,f as H,K as f,L as he,M as _e,N as pe,x,u as R,at as de,au as me,h as te,r as U,w as X,Q as C,O as se,ae as le,j as Y,m as j,o as M,v as B,I as ve}from"../../../../../chunks/vendor-6d2fcc6d.js";import{r as re}from"../../../../../chunks/request-from-api-ea26a6d7.js";import"../../../../../chunks/notifications-9151d538.js";async function $e({queue:a,namespace:e},l=fetch){const s=await re(`/namespaces/${e}/task-queues/${a}?task_queue_type=1`,{request:l}),t=await re(`/namespaces/${e}/task-queues/${a}?task_queue_type=2`,{request:l});t.pollers.forEach(n=>{n.taskQueueTypes=["ACTIVITY"]}),s.pollers.forEach(n=>{n.taskQueueTypes=["WORKFLOW"]});const c=n=>(r,u)=>{const o=r[u.identity]||{lastAccessTime:void 0,taskQueueTypes:[]};return r[u.identity]={lastAccessTime:!o.lastAccessTime||o.lastAccessTime<u.lastAccessTime?u.lastAccessTime:o.lastAccessTime,taskQueueTypes:o.taskQueueTypes.concat([n])},r};return t.pollers.filter(n=>s.pollers.some(r=>{if(n.identity===r.identity)return n.taskQueueTypes=[...r.taskQueueTypes,...n.taskQueueTypes],n})),t.pollers.reduce(c("ACTIVITY"),s.pollers.reduce(c("WORKFLOW"),{})),{pollers:t.pollers,taskQueueStatus:t.taskQueueStatus}}const Te=a=>({}),ae=a=>({});function be(a){let e,l,s,t,c,n,r,u,o,p,w,Q,T,k,N,O;const y=a[1].rows,h=fe(y,a,a[0],ae);return{c(){e=m("table"),l=m("thead"),s=m("tr"),t=m("th"),c=P("Identity"),n=L(),r=m("th"),u=P("Last Access Time"),o=L(),p=m("th"),w=P("WORKFLOW TASK HANDLER"),Q=L(),T=m("th"),k=P("ACTIVITY HANDLER"),N=L(),h&&h.c(),this.h()},l(b){e=v(b,"TABLE",{class:!0});var E=$(e);l=v(E,"THEAD",{});var A=$(l);s=v(A,"TR",{class:!0});var D=$(s);t=v(D,"TH",{class:!0});var F=$(t);c=W(F,"Identity"),F.forEach(i),n=q(D),r=v(D,"TH",{class:!0});var I=$(r);u=W(I,"Last Access Time"),I.forEach(i),o=q(D),p=v(D,"TH",{class:!0});var V=$(p);w=W(V,"WORKFLOW TASK HANDLER"),V.forEach(i),Q=q(D),T=v(D,"TH",{class:!0});var _=$(T);k=W(_,"ACTIVITY HANDLER"),_.forEach(i),D.forEach(i),A.forEach(i),N=q(E),h&&h.l(E),E.forEach(i),this.h()},h(){g(t,"class","w-6/12 svelte-1sl6inl"),g(r,"class","w-2/12 svelte-1sl6inl"),g(p,"class","w-2/12 svelte-1sl6inl"),g(T,"class","w-2/12 svelte-1sl6inl"),g(s,"class","bg-gray-200"),g(e,"class","border-collapse w-full")},m(b,E){H(b,e,E),f(e,l),f(l,s),f(s,t),f(t,c),f(s,n),f(s,r),f(r,u),f(s,o),f(s,p),f(p,w),f(s,Q),f(s,T),f(T,k),f(e,N),h&&h.m(e,null),O=!0},p(b,[E]){h&&h.p&&(!O||E&1)&&he(h,y,b,b[0],O?pe(y,b[0],E,Te):_e(b[0]),ae)},i(b){O||(x(h,b),O=!0)},o(b){R(h,b),O=!1},d(b){b&&i(e),h&&h.d(b)}}}function ge(a,e,l){let{$$slots:s={},$$scope:t}=e;return a.$$set=c=>{"$$scope"in c&&l(0,t=c.$$scope)},[t,s]}class ke extends J{constructor(e){super();z(this,e,ge,be,G,{})}}function oe(a){return a?(ne(a)&&(a=ye(a)),de(me(a),"MMMM dd, yyyy \u2014 h:mm a")):""}function ye(a){if(!ne(a))throw new TypeError("provided value is not a timestamp");const e=new Date(null);return e.setTime(Number(a.seconds)*1e3+a.nanos/1e3),e}function ne(a){return typeof a=="object"?a.seconds!==void 0&&a.nanos!==void 0:!1}function we(a){let e;return{c(){e=m("td"),this.h()},l(l){e=v(l,"TD",{class:!0}),$(e).forEach(i),this.h()},h(){g(e,"class","svelte-etbx4x")},m(l,s){H(l,e,s)},p:C,i:C,o:C,d(l){l&&i(e)}}}function Ee(a){let e,l,s;return l=new se({props:{src:le,class:"w-8 h-8 pl-3"}}),{c(){e=m("td"),Y(l.$$.fragment),this.h()},l(t){e=v(t,"TD",{class:!0});var c=$(e);j(l.$$.fragment,c),c.forEach(i),this.h()},h(){g(e,"class","svelte-etbx4x")},m(t,c){H(t,e,c),M(l,e,null),s=!0},p:C,i(t){s||(x(l.$$.fragment,t),s=!0)},o(t){R(l.$$.fragment,t),s=!1},d(t){t&&i(e),B(l)}}}function xe(a){let e;return{c(){e=m("td"),this.h()},l(l){e=v(l,"TD",{class:!0}),$(e).forEach(i),this.h()},h(){g(e,"class","svelte-etbx4x")},m(l,s){H(l,e,s)},p:C,i:C,o:C,d(l){l&&i(e)}}}function Ae(a){let e,l,s;return l=new se({props:{src:le,class:"w-8 h-8 pl-3"}}),{c(){e=m("td"),Y(l.$$.fragment),this.h()},l(t){e=v(t,"TD",{class:!0});var c=$(e);j(l.$$.fragment,c),c.forEach(i),this.h()},h(){g(e,"class","svelte-etbx4x")},m(t,c){H(t,e,c),M(l,e,null),s=!0},p:C,i(t){s||(x(l.$$.fragment,t),s=!0)},o(t){R(l.$$.fragment,t),s=!1},d(t){t&&i(e),B(l)}}}function De(a){let e,l,s,t=a[0].identity+"",c,n,r,u,o=oe(a[0].lastAccessTime)+"",p,w,Q,T,k,N,O,y,h,b;const E=[Ee,we],A=[];function D(_,d){return(Q==null||d&1)&&(Q=!!_[0].taskQueueTypes.includes("WORKFLOW")),Q?0:1}T=D(a,-1),k=A[T]=E[T](a);const F=[Ae,xe],I=[];function V(_,d){return(O==null||d&1)&&(O=!!_[0].taskQueueTypes.includes("ACTIVITY")),O?0:1}return y=V(a,-1),h=I[y]=F[y](a),{c(){e=m("tr"),l=m("td"),s=m("h3"),c=P(t),n=L(),r=m("td"),u=m("p"),p=P(o),w=L(),k.c(),N=L(),h.c(),this.h()},l(_){e=v(_,"TR",{class:!0});var d=$(e);l=v(d,"TD",{class:!0});var K=$(l);s=v(K,"H3",{class:!0});var S=$(s);c=W(S,t),S.forEach(i),K.forEach(i),n=q(d),r=v(d,"TD",{class:!0});var Z=$(r);u=v(Z,"P",{class:!0});var ee=$(u);p=W(ee,o),ee.forEach(i),Z.forEach(i),w=q(d),k.l(d),N=q(d),h.l(d),d.forEach(i),this.h()},h(){g(s,"class","svelte-etbx4x"),g(l,"class","svelte-etbx4x"),g(u,"class","svelte-etbx4x"),g(r,"class","svelte-etbx4x"),g(e,"class","svelte-etbx4x")},m(_,d){H(_,e,d),f(e,l),f(l,s),f(s,c),f(e,n),f(e,r),f(r,u),f(u,p),f(e,w),A[T].m(e,null),f(e,N),I[y].m(e,null),b=!0},p(_,[d]){(!b||d&1)&&t!==(t=_[0].identity+"")&&te(c,t),(!b||d&1)&&o!==(o=oe(_[0].lastAccessTime)+"")&&te(p,o);let K=T;T=D(_,d),T===K?A[T].p(_,d):(U(),R(A[K],1,1,()=>{A[K]=null}),X(),k=A[T],k?k.p(_,d):(k=A[T]=E[T](_),k.c()),x(k,1),k.m(e,N));let S=y;y=V(_,d),y===S?I[y].p(_,d):(U(),R(I[S],1,1,()=>{I[S]=null}),X(),h=I[y],h?h.p(_,d):(h=I[y]=F[y](_),h.c()),x(h,1),h.m(e,null))},i(_){b||(x(k),x(h),b=!0)},o(_){R(k),R(h),b=!1},d(_){_&&i(e),A[T].d(),I[y].d()}}}function Ie(a,e,l){let{poller:s}=e;return a.$$set=t=>{"poller"in t&&l(0,s=t.poller)},[s]}class Re extends J{constructor(e){super();z(this,e,Ie,De,G,{poller:0})}}function ce(a,e,l){const s=a.slice();return s[1]=e[l],s}function ue(a){let e,l,s,t;return{c(){e=m("tr"),l=m("td"),s=P("No Results"),t=L(),this.h()},l(c){e=v(c,"TR",{});var n=$(e);l=v(n,"TD",{colspan:!0,class:!0});var r=$(l);s=W(r,"No Results"),r.forEach(i),t=q(n),n.forEach(i),this.h()},h(){g(l,"colspan","4"),g(l,"class","m-auto p-12 text-center font-extralight text-2xl")},m(c,n){H(c,e,n),f(e,l),f(l,s),f(e,t)},d(c){c&&i(e)}}}function ie(a){let e,l;return e=new Re({props:{poller:a[1]}}),{c(){Y(e.$$.fragment)},l(s){j(e.$$.fragment,s)},m(s,t){M(e,s,t),l=!0},p(s,t){const c={};t&1&&(c.poller=s[1]),e.$set(c)},i(s){l||(x(e.$$.fragment,s),l=!0)},o(s){R(e.$$.fragment,s),l=!1},d(s){B(e,s)}}}function Qe(a){let e,l,s=a[0].pollers,t=[];for(let r=0;r<s.length;r+=1)t[r]=ie(ce(a,s,r));const c=r=>R(t[r],1,1,()=>{t[r]=null});let n=null;return s.length||(n=ue()),{c(){e=m("tbody");for(let r=0;r<t.length;r+=1)t[r].c();n&&n.c(),this.h()},l(r){e=v(r,"TBODY",{slot:!0});var u=$(e);for(let o=0;o<t.length;o+=1)t[o].l(u);n&&n.l(u),u.forEach(i),this.h()},h(){g(e,"slot","rows")},m(r,u){H(r,e,u);for(let o=0;o<t.length;o+=1)t[o].m(e,null);n&&n.m(e,null),l=!0},p(r,u){if(u&1){s=r[0].pollers;let o;for(o=0;o<s.length;o+=1){const p=ce(r,s,o);t[o]?(t[o].p(p,u),x(t[o],1)):(t[o]=ie(p),t[o].c(),x(t[o],1),t[o].m(e,null))}for(U(),o=s.length;o<t.length;o+=1)c(o);X(),s.length?n&&(n.d(1),n=null):n||(n=ue(),n.c(),n.m(e,null))}},i(r){if(!l){for(let u=0;u<s.length;u+=1)x(t[u]);l=!0}},o(r){t=t.filter(Boolean);for(let u=0;u<t.length;u+=1)R(t[u]);l=!1},d(r){r&&i(e),ve(t,r),n&&n.d()}}}function Oe(a){let e,l,s,t,c,n,r,u;return r=new ke({props:{$$slots:{rows:[Qe]},$$scope:{ctx:a}}}),{c(){e=m("section"),l=m("header"),s=m("h3"),t=P("Pollers"),c=L(),n=m("div"),Y(r.$$.fragment),this.h()},l(o){e=v(o,"SECTION",{class:!0});var p=$(e);l=v(p,"HEADER",{class:!0});var w=$(l);s=v(w,"H3",{class:!0});var Q=$(s);t=W(Q,"Pollers"),Q.forEach(i),w.forEach(i),c=q(p),n=v(p,"DIV",{class:!0});var T=$(n);j(r.$$.fragment,T),T.forEach(i),p.forEach(i),this.h()},h(){g(s,"class","text-2xl"),g(l,"class","p-3 mb-5"),g(n,"class","w-full h-full overflow-x-scroll"),g(e,"class","flex flex-col items-start")},m(o,p){H(o,e,p),f(e,l),f(l,s),f(s,t),f(e,c),f(e,n),M(r,n,null),u=!0},p(o,[p]){const w={};p&17&&(w.$$scope={dirty:p,ctx:o}),r.$set(w)},i(o){u||(x(r.$$.fragment,o),u=!0)},o(o){R(r.$$.fragment,o),u=!1},d(o){o&&i(e),B(r)}}}async function Pe({fetch:a,page:e}){const{namespace:l,queue:s}=e.params;return await $e({queue:s,namespace:l},a).then(t=>({props:{pollers:t}}))}function Le(a,e,l){let{pollers:s}=e;return a.$$set=t=>{"pollers"in t&&l(0,s=t.pollers)},[s]}class We extends J{constructor(e){super();z(this,e,Le,Oe,G,{pollers:0})}}export{We as default,Pe as load};

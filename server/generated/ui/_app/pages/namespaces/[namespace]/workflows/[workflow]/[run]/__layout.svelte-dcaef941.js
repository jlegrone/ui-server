import{S as L,i as U,s as V,j as P,m as D,o as M,x as g,u as $,v as O,l as se,f as B,r as fe,w as ie,d as w,t as q,g as F,e as p,c as d,a as k,b as h,T as ae,K as u,Q as ne,G as ce,O as ue,ap as me,k as S,n as T,h as re,J as we,L as he,M as _e,N as pe}from"../../../../../../chunks/vendor-6d2fcc6d.js";import{B as de,i as ke,g as ge,W as ve,a as $e}from"../../../../../../chunks/button-994ad580.js";import{r as Ee,h as be}from"../../../../../../chunks/request-from-api-ea26a6d7.js";import{n as ye}from"../../../../../../chunks/notifications-9151d538.js";import{p as Ie}from"../../../../../../chunks/data-converter-config-53dafe45.js";import{p as oe}from"../../../../../../chunks/path-matches-f07ba012.js";async function Ae({workflow:r,namespace:e,reason:t}){return await Ee(`/namespaces/${e}/workflows/${r.id}/executions/${r.runId}/terminate`,{options:{method:"POST",body:JSON.stringify({reason:t})},shouldRetry:!1})}function le(r){let e,t;return e=new de({props:{variant:"destroy",size:"small",$$slots:{default:[Ne]},$$scope:{ctx:r}}}),e.$on("click",r[2]),{c(){P(e.$$.fragment)},l(a){D(e.$$.fragment,a)},m(a,s){M(e,a,s),t=!0},p(a,s){const n={};s&64&&(n.$$scope={dirty:s,ctx:a}),e.$set(n)},i(a){t||(g(e.$$.fragment,a),t=!0)},o(a){$(e.$$.fragment,a),t=!1},d(a){O(e,a)}}}function Ne(r){let e;return{c(){e=q("Terminate")},l(t){e=F(t,"Terminate")},m(t,a){B(t,e,a)},d(t){t&&w(e)}}}function je(r){let e=r[1](r[0]),t,a,s=e&&le(r);return{c(){s&&s.c(),t=se()},l(n){s&&s.l(n),t=se()},m(n,l){s&&s.m(n,l),B(n,t,l),a=!0},p(n,[l]){l&1&&(e=n[1](n[0])),e?s?(s.p(n,l),l&1&&g(s,1)):(s=le(n),s.c(),g(s,1),s.m(t.parentNode,t)):s&&(fe(),$(s,1,1,()=>{s=null}),ie())},i(n){a||(g(s),a=!0)},o(n){$(s),a=!1},d(n){s&&s.d(n),n&&w(t)}}}function Se(r,e,t){let{workflow:a}=e,{namespace:s}=e,{refresh:n=null}=e,l="";const o=i=>String(i.status)==="Running",f=()=>{Ae({workflow:a,namespace:s,reason:l}).then(()=>{l="",ye.add("success","Workflow Terminated"),ke(n)&&n()}).catch(be)};return r.$$set=i=>{"workflow"in i&&t(0,a=i.workflow),"namespace"in i&&t(3,s=i.namespace),"refresh"in i&&t(4,n=i.refresh)},[a,o,f,s,n]}class Te extends L{constructor(e){super();U(this,e,Se,je,V,{workflow:0,namespace:3,refresh:4})}}function We(r){let e,t,a,s,n;return{c(){e=p("nav"),t=p("a"),a=q("History "),s=p("span"),n=q(r[2]),this.h()},l(l){e=d(l,"NAV",{class:!0});var o=k(e);t=d(o,"A",{href:!0,class:!0});var f=k(t);a=F(f,"History "),s=d(f,"SPAN",{class:!0});var i=k(s);n=F(i,r[2]),i.forEach(w),f.forEach(w),o.forEach(w),this.h()},h(){h(s,"class","inline px-2 svelte-1ksyts3"),h(t,"href",r[0]),h(t,"class","svelte-1ksyts3"),ae(t,"active",oe(r[0],r[1].path,!0)),h(e,"class","mt-6 px-6 flex")},m(l,o){B(l,e,o),u(e,t),u(t,a),u(t,s),u(s,n)},p(l,[o]){o&1&&h(t,"href",l[0]),o&3&&ae(t,"active",oe(l[0],l[1].path,!0))},i:ne,o:ne,d(l){l&&w(e)}}}function He(r,e,t){let a,s;ce(r,Ie,m=>t(1,s=m));const{namespace:n,workflow:l,run:o}=s.params;let{workflow:f}=e;const i=f==null?void 0:f.historyEvents;return r.$$set=m=>{"workflow"in m&&t(3,f=m.workflow)},t(0,a=ge(n,{id:l,runId:o})),[a,s,i,f]}class Pe extends L{constructor(e){super();U(this,e,He,We,V,{workflow:3})}}function De(r){var x;let e,t,a,s,n,l,o,f,i=r[0].name+"",m,G,W,E,K,b,Q,y,H,X,Y,R=r[0].id+"",C,Z,I,N;return l=new ue({props:{src:me,class:"inline w-5 h-5 text-gray-500 cursor-pointer"}}),E=new ve({props:{status:(x=r[0])==null?void 0:x.status}}),b=new Te({props:{workflow:r[0],namespace:r[1]}}),I=new Pe({props:{workflow:r[0]}}),{c(){e=p("header"),t=p("main"),a=p("div"),s=p("h1"),n=p("a"),P(l.$$.fragment),f=S(),m=q(i),G=S(),W=p("span"),P(E.$$.fragment),K=S(),P(b.$$.fragment),Q=S(),y=p("p"),H=p("span"),X=q("Workflow ID"),Y=S(),C=q(R),Z=S(),P(I.$$.fragment),this.h()},l(c){e=d(c,"HEADER",{class:!0});var _=k(e);t=d(_,"MAIN",{class:!0});var j=k(t);a=d(j,"DIV",{class:!0});var A=k(a);s=d(A,"H1",{class:!0});var v=k(s);n=d(v,"A",{href:!0});var z=k(n);D(l.$$.fragment,z),z.forEach(w),f=T(v),m=F(v,i),G=T(v),W=d(v,"SPAN",{class:!0});var ee=k(W);D(E.$$.fragment,ee),ee.forEach(w),v.forEach(w),K=T(A),D(b.$$.fragment,A),A.forEach(w),Q=T(j),y=d(j,"P",{class:!0});var J=k(y);H=d(J,"SPAN",{class:!0});var te=k(H);X=F(te,"Workflow ID"),te.forEach(w),Y=T(J),C=F(J,R),J.forEach(w),j.forEach(w),Z=T(_),D(I.$$.fragment,_),_.forEach(w),this.h()},h(){h(n,"href",o=`/namespaces/${r[1]}/workflows`),h(W,"class","inline"),h(s,"class","text-lg"),h(a,"class","flex m-0 mt-6 justify-between items-center"),h(H,"class","uppercase text-gray-400 mr-2"),h(y,"class","text-gray-500 text-xs svelte-19ze9pv"),h(t,"class","px-6 mb-2"),h(e,"class","flex flex-col justify-between")},m(c,_){B(c,e,_),u(e,t),u(t,a),u(a,s),u(s,n),M(l,n,null),u(s,f),u(s,m),u(s,G),u(s,W),M(E,W,null),u(a,K),M(b,a,null),u(t,Q),u(t,y),u(y,H),u(H,X),u(y,Y),u(y,C),u(e,Z),M(I,e,null),N=!0},p(c,[_]){var z;(!N||_&2&&o!==(o=`/namespaces/${c[1]}/workflows`))&&h(n,"href",o),(!N||_&1)&&i!==(i=c[0].name+"")&&re(m,i);const j={};_&1&&(j.status=(z=c[0])==null?void 0:z.status),E.$set(j);const A={};_&1&&(A.workflow=c[0]),_&2&&(A.namespace=c[1]),b.$set(A),(!N||_&1)&&R!==(R=c[0].id+"")&&re(C,R);const v={};_&1&&(v.workflow=c[0]),I.$set(v)},i(c){N||(g(l.$$.fragment,c),g(E.$$.fragment,c),g(b.$$.fragment,c),g(I.$$.fragment,c),N=!0)},o(c){$(l.$$.fragment,c),$(E.$$.fragment,c),$(b.$$.fragment,c),$(I.$$.fragment,c),N=!1},d(c){c&&w(e),O(l),O(E),O(b),O(I)}}}function Me(r,e,t){let{workflow:a}=e,{namespace:s}=e;return r.$$set=n=>{"workflow"in n&&t(0,a=n.workflow),"namespace"in n&&t(1,s=n.namespace)},[a,s]}class Oe extends L{constructor(e){super();U(this,e,Me,De,V,{workflow:0,namespace:1})}}function qe(r){let e,t,a,s,n;a=new Oe({props:{workflow:r[0],namespace:r[1]}});const l=r[3].default,o=we(l,r,r[2],null);return{c(){e=p("section"),t=p("main"),P(a.$$.fragment),s=S(),o&&o.c(),this.h()},l(f){e=d(f,"SECTION",{class:!0});var i=k(e);t=d(i,"MAIN",{class:!0});var m=k(t);D(a.$$.fragment,m),s=T(m),o&&o.l(m),m.forEach(w),i.forEach(w),this.h()},h(){h(t,"class","w-full"),h(e,"class","border-l-2 h-screen")},m(f,i){B(f,e,i),u(e,t),M(a,t,null),u(t,s),o&&o.m(t,null),n=!0},p(f,[i]){const m={};i&1&&(m.workflow=f[0]),i&2&&(m.namespace=f[1]),a.$set(m),o&&o.p&&(!n||i&4)&&he(o,l,f,f[2],n?pe(l,f[2],i,null):_e(f[2]),null)},i(f){n||(g(a.$$.fragment,f),g(o,f),n=!0)},o(f){$(a.$$.fragment,f),$(o,f),n=!1},d(f){f&&w(e),O(a),o&&o.d(f)}}}async function Ue({page:r}){const{workflow:e,run:t,namespace:a}=r.params,{workflow:s,events:n}=await $e({namespace:a,executionId:e,runId:t});return{props:{workflow:s,namespace:a},stuff:{workflow:s,events:n}}}function Fe(r,e,t){let{$$slots:a={},$$scope:s}=e,{workflow:n}=e,{namespace:l}=e;return r.$$set=o=>{"workflow"in o&&t(0,n=o.workflow),"namespace"in o&&t(1,l=o.namespace),"$$scope"in o&&t(2,s=o.$$scope)},[n,l,s,a]}class Ve extends L{constructor(e){super();U(this,e,Fe,qe,V,{workflow:0,namespace:1})}}export{Ve as default,Ue as load};
